<!doctype html>
<html lang="en">

<head>
  <title>Title</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">

</head>

<body>
    <section class="events_table bg-light p-5">
        <h3 class="mb-5">Eventi in arrivo</h3>
        <div class="table-responsive">
            <table class="table bg-white">
                <thead class="bg-dark text-light">
                    <tr>
                        <th>Tipologia</th>
                        <th>Descrizione</th>
                        <th>Posizione</th>
                        <th>Pagina evento</th>
                    </tr>
                </thead>
                <tbody id="eventi_arrivo">
                    
                </tbody>
            </table>
        </div>
    </section>

    <section class="events_table bg-light p-5">
        <h3 class="mb-5">Eventi trascorsi</h3>
        <div class="table-responsive">
            <table class="table">
                <thead class="bg-dark text-light">
                    <tr>
                        <th>Tipologia</th>
                        <th>Descrizione</th>
                        <th>Posizione</th>
                        <th>Pagina evento</th>
                    </tr>
                </thead>
                <tbody id="eventi_trascorsi">
                    
                </tbody>
            </table>
        </div>
    </section>
    

        
    </div>






    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm" crossorigin="anonymous"></script>


    <script>
        // recupero i <tbody> delle 2 tabelle
        let eventi_arrivo = document.querySelector("#eventi_arrivo");
        let eventi_trascorsi = document.querySelector("#eventi_trascorsi");

        function createRow() {

            // POPOLO LA TABELLA DEGLI EVENTI IN ARRIVO
            fetch("http://localhost:9007/api/eventiArrivo")
                .then(response => response.json())
                .then(data => {

                    // ordino l'array di eventi in arrivo sulla base della data evento

                    data.sort(function(evenoA, eventoB){
                        return eventoB.data - evenoA.data;
                    })

                    // ciclo l'array con gli eventi ordinati e per ogni oggetto evento creo una riga nella tabella 

                    data.forEach(evento => {
                        
                        const TR = document.createElement('tr'); // riga evento
                        const TD1 = document.createElement('td')
                        TD1.textContent = evento.tipologia
                        const TD2 = document.createElement('td')
                        TD2.textContent = evento.descrizione
                        const TD3 = document.createElement('td')
                        TD3.textContent = evento.luogo_evento

                        // la pagina del singolo evento pagina viene prodotta dinamicamente in funzione dell’ID dell’evento ricevuto come parametro di una GET

                        const TD4 = document.createElement('td')

                        TD4.innerHTML = `<a href="http://localhost:9003/api/eventiArrivo/${evento.id}">Vai alla pagina evento</a>`;
    
                        TR.append(TD1, TD2, TD3, TD4)
    
                        eventi_arrivo.append(TR)
                    });
                })


            // POPOLO LA TABELLA DEGLI EVENTI TRASCORSI
            fetch("http://localhost:9007/api/eventiTrascorsi")
                .then(response => response.json())
                .then(data => {
                    data.forEach(evento => {
                        
                        const TR = document.createElement('tr'); // riga evento
                        const TD1 = document.createElement('td')
                        TD1.textContent = evento.tipologia
                        const TD2 = document.createElement('td')
                        TD2.textContent = evento.descrizione
                        const TD3 = document.createElement('td')
                        TD3.textContent = evento.luogo_evento

                        // la pagina del singolo evento pagina viene prodotta dinamicamente in funzione dell’ID dell’evento ricevuto come parametro di una GET

                        const TD4 = document.createElement('td')

                        TD4.innerHTML = `<a href="http://localhost:9003/api/eventiTrascorsi/${evento.id}">Vai alla pagina evento</a>`;
    
                        TR.append(TD1, TD2, TD3, TD4)
    
                        eventi_arrivo.append(TR)
                    });
                })
        }

        // al caricamento del dom vengono create le righe delle tabelle eventi
        document.addEventListener("DOMContentLoaded", createRow);

    </script>
</body>

</html>